# üèõÔ∏è Sistema de Requisi√ß√µes - Igreja Batista Vida Abundante

Sistema completo de gerenciamento de requisi√ß√µes para eventos e controle de invent√°rio da Igreja Batista Vida Abundante.

## üìã √çndice

- [Vis√£o Geral](#vis√£o-geral)
- [Funcionalidades](#funcionalidades)
- [Tecnologias](#tecnologias)
- [Instala√ß√£o](#instala√ß√£o)
- [Configura√ß√£o](#configura√ß√£o)
- [Uso](#uso)
- [API](#api)
- [Estrutura do Projeto](#estrutura-do-projeto)
- [Contribui√ß√£o](#contribui√ß√£o)

## üéØ Vis√£o Geral

O Sistema de Requisi√ß√µes √© uma aplica√ß√£o web completa desenvolvida para gerenciar requisi√ß√µes de espa√ßos, equipamentos e materiais da Igreja Batista Vida Abundante. O sistema oferece controle de conflitos de hor√°rios, gest√£o de invent√°rio em tempo real e interface intuitiva para diferentes n√≠veis de usu√°rio.

## ‚ú® Funcionalidades

### üîê Sistema de Autentica√ß√£o e Autoriza√ß√£o

- **Login Multi-n√≠vel**: Suporte para diferentes tipos de usu√°rio (L√≠deres, Pastores, Administradores)
- **Controle de Acesso**: Permiss√µes espec√≠ficas por tipo de usu√°rio
- **Sess√µes Seguras**: Autentica√ß√£o JWT com tokens seguros
- **Prote√ß√£o de Rotas**: Middleware de autentica√ß√£o em todas as rotas protegidas

### üìÖ Gest√£o de Requisi√ß√µes

#### **Cria√ß√£o de Requisi√ß√µes**
- Formul√°rio completo para cria√ß√£o de requisi√ß√µes
- Sele√ß√£o de departamento, local, data e hor√°rio
- Descri√ß√£o detalhada do evento
- Estimativa de p√∫blico esperado
- Sistema de prioridades (NORMAL, ALTA, URGENTE)

#### **Valida√ß√£o em Tempo Real**
- **Verifica√ß√£o de Conflitos**: Detec√ß√£o autom√°tica de conflitos de hor√°rio e local
- **Alertas Visuais**: Interface intuitiva com cores e √≠cones
- **Sugest√µes Inteligentes**: Hor√°rios alternativos sugeridos automaticamente
- **Feedback Imediato**: Valida√ß√£o conforme o usu√°rio digita

#### **Sistema de Conflitos Avan√ßado**
- **Conflitos Diretos**: Impede cria√ß√£o quando h√° sobreposi√ß√£o total
- **Conflitos de Intervalo**: Marca como `PENDENTE_CONFLITO` quando h√° menos de 15 minutos entre eventos
- **Regra de Aprova√ß√£o**: Conflitos s√≥ ocorrem com requisi√ß√µes aprovadas (`APTO`, `EXECUTADO`, `FINALIZADO`)
- **M√∫ltiplas Requisi√ß√µes Pendentes**: Permite m√∫ltiplas requisi√ß√µes pendentes para o mesmo hor√°rio/local

#### **Sugest√µes de Hor√°rios**
- **Sugest√£o 1**: 1 hora antes at√© 15 minutos antes do conflito
- **Sugest√£o 2**: 15 minutos depois do conflito at√© 22:00
- **Aplica√ß√£o Autom√°tica**: Bot√£o "Usar" para aplicar sugest√£o automaticamente
- **Valida√ß√£o Inteligente**: Verifica se sugest√µes s√£o v√°lidas antes de mostrar

### üè¢ Gest√£o de Locais e Salas

#### **Configura√ß√£o de Locais**
- **Anexo 1 - Sal√£o**: Capacidade e caracter√≠sticas espec√≠ficas
- **Anexo 2 - Sal√£o**: Configura√ß√µes independentes
- **Templo Principal**: Espa√ßo principal da igreja
- **Sala de Reuni√£o**: Espa√ßo para reuni√µes menores
- **√Årea Externa**: Espa√ßos ao ar livre

#### **Controle de Disponibilidade**
- Verifica√ß√£o em tempo real de disponibilidade
- Hist√≥rico de uso por local
- Capacidade e limita√ß√µes por espa√ßo

### üì¶ Sistema de Invent√°rio Avan√ßado

#### **Controle de Materiais**
- **Cadastro Completo**: Nome, descri√ß√£o, categoria, quantidade total
- **Status Autom√°tico**: `DISPONIVEL`, `BAIXO_ESTOQUE`, `INDISPONIVEL`
- **Quantidade Dispon√≠vel**: Controle preciso de unidades dispon√≠veis
- **Categoriza√ß√£o**: Organiza√ß√£o por tipos (AUDIO, VIDEO, CABOS, etc.)

#### **Reserva Autom√°tica de Materiais**
- **Aprova√ß√£o Inteligente**: Materiais s√£o reservados automaticamente na aprova√ß√£o
- **Controle de Quantidade**: Apenas a quantidade solicitada √© reservada
- **Status Din√¢mico**: Atualiza√ß√£o autom√°tica de status baseada na quantidade
- **Hist√≥rico Completo**: Registro de todas as movimenta√ß√µes

#### **Verifica√ß√£o em Tempo Real**
- **Alertas de Indisponibilidade**: Materiais sem quantidade suficiente
- **Alertas de Baixo Estoque**: Materiais que ficar√£o com ‚â§ 2 unidades
- **Interface Visual**: Cores e √≠cones para diferentes tipos de alerta
- **Informa√ß√µes Detalhadas**: Quantidade dispon√≠vel, solicitada e faltante

#### **Retorno de Materiais**
- **Sistema de Devolu√ß√£o**: Materiais retornam ao estoque ap√≥s uso
- **Restaura√ß√£o de Status**: Status atualizado automaticamente
- **Hist√≥rico de Movimenta√ß√µes**: Registro completo de entrada e sa√≠da

### üë• Gest√£o de Usu√°rios

#### **Tipos de Usu√°rio**
- **L√≠deres**: Podem criar requisi√ß√µes e visualizar status
- **Pastores**: Podem aprovar/rejeitar requisi√ß√µes
- **Administradores**: Acesso completo ao sistema
- **Audiovisual**: Controle espec√≠fico de equipamentos

#### **Perfis e Permiss√µes**
- Controle granular de acesso por funcionalidade
- Interface adaptada por tipo de usu√°rio
- Logs de atividades por usu√°rio

### üìä Dashboard e Relat√≥rios

#### **Dashboard do Usu√°rio**
- **Requisi√ß√µes Ativas**: Visualiza√ß√£o das pr√≥prias requisi√ß√µes
- **Status em Tempo Real**: Atualiza√ß√µes autom√°ticas de status
- **Hist√≥rico Pessoal**: Todas as requisi√ß√µes do usu√°rio
- **A√ß√µes R√°pidas**: Bot√µes para a√ß√µes comuns

#### **Dashboard Administrativo**
- **Vis√£o Geral**: Todas as requisi√ß√µes do sistema
- **Filtros Avan√ßados**: Por status, data, departamento, local
- **A√ß√µes em Massa**: Aprova√ß√£o/rejei√ß√£o m√∫ltipla
- **Estat√≠sticas**: M√©tricas de uso e ocupa√ß√£o

#### **Dashboard Audiovisual**
- **Controle de Equipamentos**: Gest√£o espec√≠fica de materiais
- **Status de Invent√°rio**: Vis√£o detalhada de disponibilidade
- **Retorno de Materiais**: Interface para devolu√ß√£o
- **Relat√≥rios de Uso**: Estat√≠sticas de utiliza√ß√£o

##### **Fluxo Completo do Dashboard Audiovisual**

O dashboard audiovisual √© o centro de controle para gerenciar todo o ciclo de vida das requisi√ß√µes, desde a prepara√ß√£o at√© a finaliza√ß√£o e devolu√ß√£o dos instrumentos.

###### **üöÄ Carregamento Inicial**
- **Requisi√ß√µes**: Todas as requisi√ß√µes do sistema
- **Eventos**: Eventos cadastrados no sistema
- **Materiais do Dia**: Itens para eventos de hoje (status APTO)
- **Materiais para Retorno**: Itens de eventos recentes (status EXECUTADO)

###### **üìä Cards de Estat√≠sticas**
- **Requisi√ß√µes Aprovadas**: Total de requisi√ß√µes no sistema
- **Em Prepara√ß√£o**: Requisi√ß√µes com status `EXECUTADO`
- **Finalizadas**: Requisi√ß√µes com status `FINALIZADO`

###### **‚ö° A√ß√µes R√°pidas**
- **Ver Requisi√ß√µes**: Acesso √† p√°gina de gerenciamento de requisi√ß√µes audiovisual
- **Gerenciar Invent√°rio**: Acesso ao sistema de invent√°rio

###### **üì¶ Materiais do Dia (TodayMaterials)**
- **Fonte**: Requisi√ß√µes com status `APTO` para hoje
- **Funcionalidades**:
  - Visualizar materiais necess√°rios para eventos de hoje
  - Separar itens como preparados (‚úì)
  - Barra de progresso mostrando separa√ß√£o
  - Expandir/recolher detalhes por requisi√ß√£o

###### **üîÑ Retorno de Instrumentos (ReturnMaterials)**

**A) Materiais para Despachar (Pr√≥ximos 7 dias)**
- **Filtro**: Itens n√£o separados de eventos pr√≥ximos
- **A√ß√£o**: Marcar como separado
- **Status**: `APTO` ‚Üí `EXECUTADO`

**B) Retorno de Instrumentos (√öltimos 7 dias)**
- **Filtro**: Itens separados de eventos recentes
- **A√ß√£o**: Marcar como retornado
- **Status**: `EXECUTADO` ‚Üí `FINALIZADO`

###### **üìÖ Calend√°rio**
- **Eventos Exibidos**: Requisi√ß√µes (APTO, EXECUTADO, FINALIZADO) + Eventos cadastrados
- **Funcionalidades**: Navega√ß√£o mensal, visualiza√ß√£o por dia, modal com detalhes

###### **üîÑ Fluxo de Status das Requisi√ß√µes**
```
PENDENTE ‚Üí APTO ‚Üí EXECUTADO ‚Üí FINALIZADO
    ‚Üì         ‚Üì        ‚Üì          ‚Üì
  Aguardando Aprovado Preparando Finalizado
  Aprova√ß√£o           Material    (Devolvido)
```

###### **üéØ A√ß√µes Principais do Audiovisual**

**Prepara√ß√£o de Materiais:**
1. Ver materiais do dia
2. Separar itens necess√°rios
3. Marcar como separado

**Execu√ß√£o de Eventos:**
1. Ver requisi√ß√µes executadas
2. Preparar materiais
3. Executar evento

**Finaliza√ß√£o:**
1. Ver materiais para retorno
2. Marcar itens como retornados
3. Finalizar requisi√ß√£o

###### **üîß Atualiza√ß√µes em Tempo Real**
- Recarregamento autom√°tico ap√≥s a√ß√µes
- Notifica√ß√µes de sucesso/erro
- Confirma√ß√µes de a√ß√µes
- Alertas de conflitos

###### **üì± Responsividade**
- **Desktop**: Layout completo com todas as se√ß√µes
- **Tablet**: Layout ajustado com se√ß√µes empilhadas
- **Mobile**: Layout otimizado para toque

### üîî Sistema de Notifica√ß√µes

#### **Alertas em Tempo Real**
- **Conflitos de Hor√°rio**: Notifica√ß√µes imediatas
- **Indisponibilidade de Materiais**: Alertas visuais
- **Status de Requisi√ß√µes**: Atualiza√ß√µes autom√°ticas
- **Sugest√µes Inteligentes**: Propostas de hor√°rios alternativos

#### **Interface de Valida√ß√£o**
- **Cores Significativas**: Vermelho para erro, laranja para aviso, verde para sucesso
- **√çcones Intuitivos**: S√≠mbolos visuais para diferentes tipos de alerta
- **Informa√ß√µes Detalhadas**: Dados completos sobre conflitos e disponibilidade
- **A√ß√µes R√°pidas**: Bot√µes para aplicar sugest√µes ou resolver conflitos

### üì± Interface Responsiva

#### **Design Moderno**
- **Interface Limpa**: Design minimalista e profissional
- **Responsividade**: Funciona em desktop, tablet e mobile
- **Acessibilidade**: Contraste adequado e navega√ß√£o por teclado
- **Performance**: Carregamento r√°pido e intera√ß√µes fluidas

#### **Experi√™ncia do Usu√°rio**
- **Feedback Visual**: Confirma√ß√µes visuais de a√ß√µes
- **Loading States**: Indicadores de carregamento
- **Valida√ß√£o em Tempo Real**: Verifica√ß√£o conforme digita√ß√£o
- **Navega√ß√£o Intuitiva**: Fluxo l√≥gico e f√°cil de usar

## üõ†Ô∏è Tecnologias

### **Backend**
- **Node.js**: Runtime JavaScript
- **Express.js**: Framework web
- **Supabase**: Banco de dados PostgreSQL
- **JWT**: Autentica√ß√£o e autoriza√ß√£o
- **CORS**: Cross-origin resource sharing

### **Frontend**
- **React**: Biblioteca JavaScript
- **Vite**: Build tool e dev server
- **CSS3**: Estiliza√ß√£o moderna
- **Fetch API**: Comunica√ß√£o com backend

### **Banco de Dados**
- **PostgreSQL**: Banco de dados relacional
- **Supabase**: Plataforma de backend-as-a-service
- **Row Level Security**: Seguran√ßa em n√≠vel de linha

## üöÄ Instala√ß√£o

### **Pr√©-requisitos**
- Node.js 18+
- npm ou yarn
- Conta no Supabase

### **1. Clone o Reposit√≥rio**
```bash
git clone <url-do-repositorio>
cd sistemaderequerimento
```

### **2. Instale as Depend√™ncias**
```bash
# Backend
cd backend
npm install

# Frontend
cd ../frontend
npm install
```

### **3. Configure as Vari√°veis de Ambiente**
```bash
# Backend (.env)
SUPABASE_URL=sua_url_do_supabase
SUPABASE_ANON_KEY=sua_chave_anonima
SUPABASE_SERVICE_ROLE_KEY=sua_chave_service_role
JWT_SECRET=seu_jwt_secret
PORT=3000
NODE_ENV=development

# Frontend (.env)
VITE_API_URL=http://localhost:3000
```

### **4. Configure o Banco de Dados**
Execute os scripts SQL no Supabase:
- `database/create_comprovantes_table.sql`
- Configura√ß√µes de RLS (Row Level Security)

### **5. Inicie os Servidores**
```bash
# Backend (Terminal 1)
cd backend
npm start

# Frontend (Terminal 2)
cd frontend
npm run dev
```

## ‚öôÔ∏è Configura√ß√£o

### **Configura√ß√£o do Supabase**
1. Crie um projeto no Supabase
2. Configure as tabelas necess√°rias
3. Configure RLS (Row Level Security)
4. Configure as pol√≠ticas de acesso

### **Configura√ß√£o de Usu√°rios**
1. Crie usu√°rios administradores
2. Configure departamentos
3. Defina permiss√µes por tipo de usu√°rio

### **Configura√ß√£o de Locais**
1. Configure os locais dispon√≠veis
2. Defina capacidades e limita√ß√µes
3. Configure hor√°rios de funcionamento

## üìñ Uso

### **Para L√≠deres**
1. Fa√ßa login no sistema
2. Acesse "Nova Requisi√ß√£o"
3. Preencha os dados do evento
4. Selecione materiais necess√°rios
5. Verifique conflitos em tempo real
6. Envie a requisi√ß√£o

### **Para Pastores**
1. Acesse o dashboard administrativo
2. Visualize requisi√ß√µes pendentes
3. Verifique conflitos e disponibilidade
4. Aprove ou rejeite requisi√ß√µes
5. Monitore o uso de materiais

### **Para Administradores**
1. Gerencie usu√°rios e permiss√µes
2. Configure locais e materiais
3. Visualize relat√≥rios e estat√≠sticas
4. Monitore o sistema completo

## üîå API

### **Endpoints de Requisi√ß√µes**

#### **POST /api/requests**
Cria uma nova requisi√ß√£o
```json
{
  "department": "JOVENS",
  "event_name": "Culto de Jovens",
  "date": "2025-01-15",
  "location": "Anexo 1 - Sal√£o",
  "start_datetime": "2025-01-15T19:00",
  "end_datetime": "2025-01-15T22:00",
  "description": "Culto semanal dos jovens",
  "expected_audience": 50,
  "prioridade": "NORMAL"
}
```

#### **GET /api/requests**
Lista todas as requisi√ß√µes (com filtros)

#### **PUT /api/requests/:id/approve**
Aprova uma requisi√ß√£o

#### **PUT /api/requests/:id/reject**
Rejeita uma requisi√ß√£o

#### **POST /api/requests/check-conflicts**
Verifica conflitos de hor√°rio
```json
{
  "date": "2025-01-15",
  "location": "Anexo 1 - Sal√£o",
  "start_time": "19:00",
  "end_time": "22:00"
}
```

#### **POST /api/requests/check-inventory-availability**
Verifica disponibilidade de materiais
```json
{
  "itens": [
    {
      "inventory_id": "uuid",
      "quantity_requested": 2
    }
  ]
}
```

### **Endpoints de Invent√°rio**

#### **GET /api/inventory**
Lista todos os itens do invent√°rio

#### **POST /api/inventory**
Cria um novo item

#### **PUT /api/inventory/:id**
Atualiza um item

### **Endpoints de Autentica√ß√£o**

#### **POST /api/auth/login**
Login de usu√°rio
```json
{
  "email": "usuario@igreja.com",
  "password": "senha123"
}
```

#### **POST /api/auth/register**
Registro de usu√°rio

## üìÅ Estrutura do Projeto

```
sistemaderequerimento/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RequestsController.js
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuthController.js
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ InventoryController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ requestsRoutes.js
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ authRoutes.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middlewares/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authMiddleware.js
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ roleMiddleware.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ supabaseClient.js
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ create_comprovantes_table.sql
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Requests.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RequestsAdmin.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Dashboard.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Modal.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Table.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ requestsService.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ dateUtils.js
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
```

## ü§ù Contribui√ß√£o

### **Como Contribuir**
1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/AmazingFeature`)
3. Commit suas mudan√ßas (`git commit -m 'Add some AmazingFeature'`)
4. Push para a branch (`git push origin feature/AmazingFeature`)
5. Abra um Pull Request

### **Padr√µes de C√≥digo**
- Use ESLint para linting
- Siga as conven√ß√µes de nomenclatura
- Documente fun√ß√µes complexas
- Teste suas mudan√ßas

### **Relat√≥rios de Bug**
- Use o template de issue
- Inclua passos para reproduzir
- Adicione screenshots se relevante
- Especifique ambiente e vers√µes

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo `LICENSE` para mais detalhes.

## üìû Suporte

Para suporte e d√∫vidas:
- Email: suporte@igreja.com
- Documenta√ß√£o: [Link para documenta√ß√£o]
- Issues: [GitHub Issues]

---

**Desenvolvido com ‚ù§Ô∏è para a Igreja Batista Vida Abundante** 